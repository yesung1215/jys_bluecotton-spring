# 🌱 BlueCotton Backend

> **챌린지 기반 커뮤니티 & 습관 형성 플랫폼 – Backend API**

BlueCotton(블루코튼)은  
사용자가 챌린지에 참여하고 하루 1회 게시글을 작성하며  
성장 단계를 쌓아가는 **챌린지 기반 커뮤니티 웹 서비스**입니다.

본 레포지토리는 BlueCotton 서비스의  
**백엔드 API 서버**를 담당합니다.

---

## 📌 프로젝트 개요

- **프로젝트명**: BlueCotton
- **개발 기간**: 2024.08 ~ 2024.11
- **형태**: 팀 프로젝트 (Frontend / Backend 분리)
- **담당 역할**
  - 게시판(오늘의 솜) 도메인 설계
  - 게시글 / 댓글 / 대댓글 CRUD
  - 이미지 업로드 데이터 구조 설계
  - 좋아요 / 신고 / 하루 1회 제한 로직 구현

---

## 🛠 기술 스택

### Backend
- Java 17
- Spring Boot
- Spring MVC
- Spring Security (JWT)
- MyBatis
- Oracle DB

## ✨ 주요 기능

### 📝 게시판 (오늘의 솜)
- 게시글 작성 / 조회 / 수정 / 삭제 (CRUD)
- 하루 1회 게시글 작성 제한 로직 적용
- 게시글 카테고리 관리
- 게시글 이미지 업로드 및 조회

### ❤️ 좋아요 / 댓글
- 게시글 좋아요 등록 및 취소
- 댓글 / 대댓글 계층형 구조 설계
- 게시글 상세 조회 시 댓글 및 대댓글 함께 반환

### 🔐 인증 / 권한
- JWT 기반 인증 처리
- 로그인 사용자만 게시글 작성 / 수정 / 삭제 가능
- 비회원 조회 API와 인증 필요 API 분리 (Public / Private)

## 🧯 트러블슈팅

### 1. 게시글과 이미지 데이터가 분리되어 저장되며 발생한 매핑 문제

- **문제**  
  게시글과 이미지가 각각 다른 테이블에 저장되어  
  게시글 조회 시 이미지 정보가 누락되는 문제가 발생함

- **원인**  
  이미지 업로드 시점에는 게시글 ID가 존재하지 않아  
  FK 연결이 불가능한 구조였음

- **해결**  
  게시글 저장 후 생성된 게시글 ID를 기준으로  
  이미지 정보를 후처리하여 매핑하도록 설계 변경

- **배운 점**  
  파일 업로드 기능은 단순 저장 문제가 아니라  
  **DB 트랜잭션 흐름을 고려한 설계가 필수**임을 경험함

### 2. 하루 1회 게시글 작성 제한 로직 구현 시 중복 요청 문제

- **문제**  
  동일 사용자가 빠르게 여러 번 요청할 경우  
  하루 1회 제한이 간헐적으로 무시되는 현상 발생

- **원인**  
  단순 조회 후 insert 구조로 인해  
  동시 요청 시 race condition이 발생함

- **해결**  
  사용자 + 날짜 기준으로 작성 여부를 검증하는 쿼리를 추가하고  
  서버 단에서 제한을 강제하도록 로직 보완

- **배운 점**  
  비즈니스 핵심 제약 조건은  
  **프론트가 아닌 서버에서 반드시 보장되어야 함**을 인식함
